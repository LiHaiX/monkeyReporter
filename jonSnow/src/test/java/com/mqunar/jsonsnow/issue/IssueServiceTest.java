package com.mqunar.jsonsnow.issue;

import com.alibaba.fastjson.JSON;
import com.mqunar.jonsnow.entity.Issue;
import com.mqunar.jonsnow.service.gitlab.IssueService;
import com.mqunar.jonsnow.utils.UrlUtils;
import org.junit.Test;

import java.io.IOException;

/**
 * Created by ironman.li on 2016/7/15.
 */
public class IssueServiceTest {

    @Test
    public void testGetAllIssue() {
        IssueService issueService = new IssueService();
        issueService.getAllIssueByProjectId(String.valueOf(UrlUtils.ADR_ATOM_FLIGHT_PROJECT_ID));

    }

    @Test
    public void testCreateNewIssue() {
        IssueService service = new IssueService();
//        Issue issue = new Issue();
//        issue.title = "tested issue with assignee";
//        issue.description = "### this is the test for multiple label";
//        issue.labels = new String[]{"monkey", "test"};
//        User user =new User();
//        user.id = 2931;
//        issue.assignee = user;
        String issueStr = "{\"description\":\"java.lang.RuntimeException: Unable to start activity ComponentInfo{com.Qunar/com.mqunar.atom.flight.activity.inland.FlightRoundwayListActivity}: java.lang.RuntimeException: android.view.InflateException: Binary XML file line #16: Error inflating class <unknown>\\n\\n\\tat android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2305)\\n\\n\\tat android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2363)\\n\\n\\tat android.app.ActivityThread.access$900(ActivityThread.java:161)\\n\\n\\tat android.app.ActivityThread$H.handleMessage(ActivityThread.java:1265)\\n\\n\\tat android.os.Handler.dispatchMessage(Handler.java:102)\\n\\n\\tat android.os.Looper.loop(Looper.java:157)\\n\\n\\tat android.app.ActivityThread.main(ActivityThread.java:5356)\\n\\n\\tat java.lang.reflect.Method.invokeNative(Native Method)\\n\\n\\tat java.lang.reflect.Method.invoke(Method.java:515)\\n\\n\\tat com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1265)\\n\\n\\tat com.android.internal.os.ZygoteInit.main(ZygoteInit.java:1081)\\n\\n\\tat dalvik.system.NativeStart.main(Native Method)\\n\\nCaused by: java.lang.RuntimeException: android.view.InflateException: Binary XML file line #16: Error inflating class <unknown>\\n\\n\\tat com.mqunar.core.basectx.activity.Util.onException(SourceFile:32)\\n\\n\\tat com.mqunar.core.basectx.activity.QFragmentActivity.onException(SourceFile:134)\\n\\n\\tat com.mqunar.core.basectx.activity.QFragmentActivity.setContentView(SourceFile:101)\\n\\n\\tat com.mqunar.patch.BaseActivity.setContentViewStandard(BaseActivity.java:165)\\n\\n\\tat com.mqunar.atom.flight.activity.inland.FlightRoundwayListActivity.onCreate(SourceFile:170)\\n\\n\\tat android.app.Activity.performCreate(Activity.java:5426)\\n\\n\\tat android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1105)\\n\\n\\tat com.mqunar.core.QInstrumentation.callActivityOnCreate(SourceFile:248)\\n\\n\\tat android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2269)\\n\\n\\t... 11 more\\n\\nCaused by: android.view.InflateException: Binary XML file line #16: Error inflating class <unknown>\\n\\n\\tat android.view.LayoutInflater.createView(LayoutInflater.java:626)\\n\\n\\tat android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:702)\\n\\n\\tat android.view.LayoutInflater.rInflate(LayoutInflater.java:761)\\n\\n\\tat android.view.LayoutInflater.parseInclude(LayoutInflater.java:855)\\n\\n\\tat android.view.LayoutInflater.rInflate(LayoutInflater.java:751)\\n\\n\\tat android.view.LayoutInflater.rInflate(LayoutInflater.java:769)\\n\\n\\tat android.view.LayoutInflater.rInflate(LayoutInflater.java:769)\\n\\n\\tat android.view.LayoutInflater.inflate(LayoutInflater.java:498)\\n\\n\\tat android.view.LayoutInflater.inflate(LayoutInflater.java:398)\\n\\n\\tat android.view.LayoutInflater.inflate(LayoutInflater.java:354)\\n\\n\\tat com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:359)\\n\\n\\tat android.app.Activity.setContentView(Activity.java:2010)\\n\\n\\tat com.mqunar.core.basectx.activity.QFragmentActivity.setContentView(SourceFile:99)\\n\\n\\t... 17 more\\n\\nCaused by: java.lang.reflect.InvocationTargetException\\n\\n\\tat java.lang.reflect.Constructor.constructNative(Native Method)\\n\\n\\tat java.lang.reflect.Constructor.newInstance(Constructor.java:423)\\n\\n\\tat android.view.LayoutInflater.createView(LayoutInflater.java:600)\\n\\n\\t... 29 more\\n\\nCaused by: java.lang.OutOfMemoryError\\n\\n\\tat android.graphics.BitmapFactory.nativeDecodeAsset(Native Method)\\n\\n\\tat android.graphics.BitmapFactory.decodeStream(BitmapFactory.java:677)\\n\\n\\tat android.graphics.BitmapFactory.decodeResourceStream(BitmapFactory.java:507)\\n\\n\\tat android.graphics.drawable.Drawable.createFromResourceStream(Drawable.java:872)\\n\\n\\tat android.content.res.Resources.loadDrawable(Resources.java:3024)\\n\\n\\tat android.content.res.TypedArray.getDrawable(TypedArray.java:602)\\n\\n\\tat android.widget.ImageView.<init>(ImageView.java:133)\\n\\n\\tat android.widget.ImageView.<init>(ImageView.java:123)\\n\\n\\tat com.mqunar.atom.flight.view.FlightImageView.<init>(SourceFile:23)\\n\\n\\t... 32 more\\n\\njava.lang.RuntimeException: android.view.InflateException: Binary XML file line #16: Error inflating class <unknown>\\n\\n\\tat com.mqunar.core.basectx.activity.Util.onException(SourceFile:32)\\n\\n\\tat com.mqunar.core.basectx.activity.QFragmentActivity.onException(SourceFile:134)\\n\\n\\tat com.mqunar.core.basectx.activity.QFragmentActivity.setContentView(SourceFile:101)\\n\\n\\tat com.mqunar.patch.BaseActivity.setContentViewStandard(BaseActivity.java:165)\\n\\n\\tat com.mqunar.atom.flight.activity.inland.FlightRoundwayListActivity.onCreate(SourceFile:170)\\n\\n\\tat android.app.Activity.performCreate(Activity.java:5426)\\n\\n\\tat android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1105)\\n\\n\\tat com.mqunar.core.QInstrumentation.callActivityOnCreate(SourceFile:248)\\n\\n\\tat android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2269)\\n\\n\\tat android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2363)\\n\\n\\tat android.app.ActivityThread.access$900(ActivityThread.java:161)\\n\\n\\tat android.app.ActivityThread$H.handleMessage(ActivityThread.java:1265)\\n\\n\\tat android.os.Handler.dispatchMessage(Handler.java:102)\\n\\n\\tat android.os.Looper.loop(Looper.java:157)\\n\\n\\tat android.app.ActivityThread.main(ActivityThread.java:5356)\\n\\n\\tat java.lang.reflect.Method.invokeNative(Native Method)\\n\\n\\tat java.lang.reflect.Method.invoke(Method.java:515)\\n\\n\\tat com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1265)\\n\\n\\tat com.android.internal.os.ZygoteInit.main(ZygoteInit.java:1081)\\n\\n\\tat dalvik.system.NativeStart.main(Native Method)\\n\\nCaused by: android.view.InflateException: Binary XML file line #16: Error inflating class <unknown>\\n\\n\\tat android.view.LayoutInflater.createView(LayoutInflater.java:626)\\n\\n\\tat android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:702)\\n\\n\\tat android.view.LayoutInflater.rInflate(LayoutInflater.java:761)\\n\\n\\tat android.view.LayoutInflater.parseInclude(LayoutInflater.java:855)\\n\\n\\tat android.view.LayoutInflater.rInflate(LayoutInflater.java:751)\\n\\n\\tat android.view.LayoutInflater.rInflate(LayoutInflater.java:769)\\n\\n\\tat android.view.LayoutInflater.rInflate(LayoutInflater.java:769)\\n\\n\\tat android.view.LayoutInflater.inflate(LayoutInflater.java:498)\\n\\n\\tat android.view.LayoutInflater.inflate(LayoutInflater.java:398)\\n\\n\\tat android.view.LayoutInflater.inflate(LayoutInflater.java:354)\\n\\n\\tat com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:359)\\n\\n\\tat android.app.Activity.setContentView(Activity.java:2010)\\n\\n\\tat com.mqunar.core.basectx.activity.QFragmentActivity.setContentView(SourceFile:99)\\n\\n\\t... 17 more\\n\\nCaused by: java.lang.reflect.InvocationTargetException\\n\\n\\tat java.lang.reflect.Constructor.constructNative(Native Method)\\n\\n\\tat java.lang.reflect.Constructor.newInstance(Constructor.java:423)\\n\\n\\tat android.view.LayoutInflater.createView(LayoutInflater.java:600)\\n\\n\\t... 29 more\\n\\nCaused by: java.lang.OutOfMemoryError\\n\\n\\tat android.graphics.BitmapFactory.nativeDecodeAsset(Native Method)\\n\\n\\tat android.graphics.BitmapFactory.decodeStream(BitmapFactory.java:677)\\n\\n\\tat android.graphics.BitmapFactory.decodeResourceStream(BitmapFactory.java:507)\\n\\n\\tat android.graphics.drawable.Drawable.createFromResourceStream(Drawable.java:872)\\n\\n\\tat android.content.res.Resources.loadDrawable(Resources.java:3024)\\n\\n\\tat android.content.res.TypedArray.getDrawable(TypedArray.java:602)\\n\\n\\tat android.widget.ImageView.<init>(ImageView.java:133)\\n\\n\\tat android.widget.ImageView.<init>(ImageView.java:123)\\n\\n\\tat com.mqunar.atom.flight.view.FlightImageView.<init>(SourceFile:23)\\n\\n\\t... 32 more\\n\\nandroid.view.InflateException: Binary XML file line #16: Error inflating class <unknown>\\n\\n\\tat android.view.LayoutInflater.createView(LayoutInflater.java:626)\\n\\n\\tat android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:702)\\n\\n\\tat android.view.LayoutInflater.rInflate(LayoutInflater.java:761)\\n\\n\\tat android.view.LayoutInflater.parseInclude(LayoutInflater.java:855)\\n\\n\\tat android.view.LayoutInflater.rInflate(LayoutInflater.java:751)\\n\\n\\tat android.view.LayoutInflater.rInflate(LayoutInflater.java:769)\\n\\n\\tat android.view.LayoutInflater.rInflate(LayoutInflater.java:769)\\n\\n\\tat android.view.LayoutInflater.inflate(LayoutInflater.java:498)\\n\\n\\tat android.view.LayoutInflater.inflate(LayoutInflater.java:398)\\n\\n\\tat android.view.LayoutInflater.inflate(LayoutInflater.java:354)\\n\\n\\tat com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:359)\\n\\n\\tat android.app.Activity.setContentView(Activity.java:2010)\\n\\n\\tat com.mqunar.core.basectx.activity.QFragmentActivity.setContentView(SourceFile:99)\\n\\n\\tat com.mqunar.patch.BaseActivity.setContentViewStandard(BaseActivity.java:165)\\n\\n\\tat com.mqunar.atom.flight.activity.inland.FlightRoundwayListActivity.onCreate(SourceFile:170)\\n\\n\\tat android.app.Activity.performCreate(Activity.java:5426)\\n\\n\\tat android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1105)\\n\\n\\tat com.mqunar.core.QInstrumentation.callActivityOnCreate(SourceFile:248)\\n\\n\\tat android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2269)\\n\\n\\tat android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2363)\\n\\n\\tat android.app.ActivityThread.access$900(ActivityThread.java:161)\\n\\n\\tat android.app.ActivityThread$H.handleMessage(ActivityThread.java:1265)\\n\\n\\tat android.os.Handler.dispatchMessage(Handler.java:102)\\n\\n\\tat android.os.Looper.loop(Looper.java:157)\\n\\n\\tat android.app.ActivityThread.main(ActivityThread.java:5356)\\n\\n\\tat java.lang.reflect.Method.invokeNative(Native Method)\\n\\n\\tat java.lang.reflect.Method.invoke(Method.java:515)\\n\\n\\tat com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1265)\\n\\n\\tat com.android.internal.os.ZygoteInit.main(ZygoteInit.java:1081)\\n\\n\\tat dalvik.system.NativeStart.main(Native Method)\\n\\nCaused by: java.lang.reflect.InvocationTargetException\\n\\n\\tat java.lang.reflect.Constructor.constructNative(Native Method)\\n\\n\\tat java.lang.reflect.Constructor.newInstance(Constructor.java:423)\\n\\n\\tat android.view.LayoutInflater.createView(LayoutInflater.java:600)\\n\\n\\t... 29 more\\n\\nCaused by: java.lang.OutOfMemoryError\\n\\n\\tat android.graphics.BitmapFactory.nativeDecodeAsset(Native Method)\\n\\n\\tat android.graphics.BitmapFactory.decodeStream(BitmapFactory.java:677)\\n\\n\\tat android.graphics.BitmapFactory.decodeResourceStream(BitmapFactory.java:507)\\n\\n\\tat android.graphics.drawable.Drawable.createFromResourceStream(Drawable.java:872)\\n\\n\\tat android.content.res.Resources.loadDrawable(Resources.java:3024)\\n\\n\\tat android.content.res.TypedArray.getDrawable(TypedArray.java:602)\\n\\n\\tat android.widget.ImageView.<init>(ImageView.java:133)\\n\\n\\tat android.widget.ImageView.<init>(ImageView.java:123)\\n\\n\\tat com.mqunar.atom.flight.view.FlightImageView.<init>(SourceFile:23)\\n\\n\\t... 32 more\\n\\njava.lang.reflect.InvocationTargetException\\n\\n\\tat java.lang.reflect.Constructor.constructNative(Native Method)\\n\\n\\tat java.lang.reflect.Constructor.newInstance(Constructor.java:423)\\n\\n\\tat android.view.LayoutInflater.createView(LayoutInflater.java:600)\\n\\n\\tat android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:702)\\n\\n\\tat android.view.LayoutInflater.rInflate(LayoutInflater.java:761)\\n\\n\\tat android.view.LayoutInflater.parseInclude(LayoutInflater.java:855)\\n\\n\\tat android.view.LayoutInflater.rInflate(LayoutInflater.java:751)\\n\\n\\tat android.view.LayoutInflater.rInflate(LayoutInflater.java:769)\\n\\n\\tat android.view.LayoutInflater.rInflate(LayoutInflater.java:769)\\n\\n\\tat android.view.LayoutInflater.inflate(LayoutInflater.java:498)\\n\\n\\tat android.view.LayoutInflater.inflate(LayoutInflater.java:398)\\n\\n\\tat android.view.LayoutInflater.inflate(LayoutInflater.java:354)\\n\\n\\tat com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:359)\\n\\n\\tat android.app.Activity.setContentView(Activity.java:2010)\\n\\n\\tat com.mqunar.core.basectx.activity.QFragmentActivity.setContentView(SourceFile:99)\\n\\n\\tat com.mqunar.patch.BaseActivity.setContentViewStandard(BaseActivity.java:165)\\n\\n\\tat com.mqunar.atom.flight.activity.inland.FlightRoundwayListActivity.onCreate(SourceFile:170)\\n\\n\\tat android.app.Activity.performCreate(Activity.java:5426)\\n\\n\\tat android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1105)\\n\\n\\tat com.mqunar.core.QInstrumentation.callActivityOnCreate(SourceFile:248)\\n\\n\\tat android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2269)\\n\\n\\tat android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2363)\\n\\n\\tat android.app.ActivityThread.access$900(ActivityThread.java:161)\\n\\n\\tat android.app.ActivityThread$H.handleMessage(ActivityThread.java:1265)\\n\\n\\tat android.os.Handler.dispatchMessage(Handler.java:102)\\n\\n\\tat android.os.Looper.loop(Looper.java:157)\\n\\n\\tat android.app.ActivityThread.main(ActivityThread.java:5356)\\n\\n\\tat java.lang.reflect.Method.invokeNative(Native Method)\\n\\n\\tat java.lang.reflect.Method.invoke(Method.java:515)\\n\\n\\tat com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1265)\\n\\n\\tat com.android.internal.os.ZygoteInit.main(ZygoteInit.java:1081)\\n\\n\\tat dalvik.system.NativeStart.main(Native Method)\\n\\nCaused by: java.lang.OutOfMemoryError\\n\\n\\tat android.graphics.BitmapFactory.nativeDecodeAsset(Native Method)\\n\\n\\tat android.graphics.BitmapFactory.decodeStream(BitmapFactory.java:677)\\n\\n\\tat android.graphics.BitmapFactory.decodeResourceStream(BitmapFactory.java:507)\\n\\n\\tat android.graphics.drawable.Drawable.createFromResourceStream(Drawable.java:872)\\n\\n\\tat android.content.res.Resources.loadDrawable(Resources.java:3024)\\n\\n\\tat android.content.res.TypedArray.getDrawable(TypedArray.java:602)\\n\\n\\tat android.widget.ImageView.<init>(ImageView.java:133)\\n\\n\\tat android.widget.ImageView.<init>(ImageView.java:123)\\n\\n\\tat com.mqunar.atom.flight.view.FlightImageView.<init>(SourceFile:23)\\n\\n\\t... 32 more\\n\\njava.lang.OutOfMemoryError\\n\\n\\tat android.graphics.BitmapFactory.nativeDecodeAsset(Native Method)\\n\\n\\tat android.graphics.BitmapFactory.decodeStream(BitmapFactory.java:677)\\n\\n\\tat android.graphics.BitmapFactory.decodeResourceStream(BitmapFactory.java:507)\\n\\n\\tat android.graphics.drawable.Drawable.createFromResourceStream(Drawable.java:872)\\n\\n\\tat android.content.res.Resources.loadDrawable(Resources.java:3024)\\n\\n\\tat android.content.res.TypedArray.getDrawable(TypedArray.java:602)\\n\\n\\tat android.widget.ImageView.<init>(ImageView.java:133)\\n\\n\\tat android.widget.ImageView.<init>(ImageView.java:123)\\n\\n\\tat com.mqunar.atom.flight.view.FlightImageView.<init>(SourceFile:23)\\n\\n\\tat java.lang.reflect.Constructor.constructNative(Native Method)\\n\\n\\tat java.lang.reflect.Constructor.newInstance(Constructor.java:423)\\n\\n\\tat android.view.LayoutInflater.createView(LayoutInflater.java:600)\\n\\n\\tat android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:702)\\n\\n\\tat android.view.LayoutInflater.rInflate(LayoutInflater.java:761)\\n\\n\\tat android.view.LayoutInflater.parseInclude(LayoutInflater.java:855)\\n\\n\\tat android.view.LayoutInflater.rInflate(LayoutInflater.java:751)\\n\\n\\tat android.view.LayoutInflater.rInflate(LayoutInflater.java:769)\\n\\n\\tat android.view.LayoutInflater.rInflate(LayoutInflater.java:769)\\n\\n\\tat android.view.LayoutInflater.inflate(LayoutInflater.java:498)\\n\\n\\tat android.view.LayoutInflater.inflate(LayoutInflater.java:398)\\n\\n\\tat android.view.LayoutInflater.inflate(LayoutInflater.java:354)\\n\\n\\tat com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:359)\\n\\n\\tat android.app.Activity.setContentView(Activity.java:2010)\\n\\n\\tat com.mqunar.core.basectx.activity.QFragmentActivity.setContentView(SourceFile:99)\\n\\n\\tat com.mqunar.patch.BaseActivity.setContentViewStandard(BaseActivity.java:165)\\n\\n\\tat com.mqunar.atom.flight.activity.inland.FlightRoundwayListActivity.onCreate(SourceFile:170)\\n\\n\\tat android.app.Activity.performCreate(Activity.java:5426)\\n\\n\\tat android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1105)\\n\\n\\tat com.mqunar.core.QInstrumentation.callActivityOnCreate(SourceFile:248)\\n\\n\\tat android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2269)\\n\\n\\tat android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2363)\\n\\n\\tat android.app.ActivityThread.access$900(ActivityThread.java:161)\\n\\n\\tat android.app.ActivityThread$H.handleMessage(ActivityThread.java:1265)\\n\\n\\tat android.os.Handler.dispatchMessage(Handler.java:102)\\n\\n\\tat android.os.Looper.loop(Looper.java:157)\\n\\n\\tat android.app.ActivityThread.main(ActivityThread.java:5356)\\n\\n\\tat java.lang.reflect.Method.invokeNative(Native Method)\\n\\n\\tat java.lang.reflect.Method.invoke(Method.java:515)\\n\\n\\tat com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1265)\\n\\n\\tat com.android.internal.os.ZygoteInit.main(ZygoteInit.java:1081)\\n\\n\\tat dalvik.system.NativeStart.main(Native Method)\\n\\n\",\"id\":0,\"iid\":0,\"milestone\":{\"created_at\":\"2016-07-15T16:54:14.000+08:00\",\"description\":\"auto created milestone to fix online crash\",\"due_date\":\"2016-07-31\",\"id\":114,\"iid\":4,\"project_id\":20941,\"state\":\"active\",\"title\":\"online_crash-84\",\"updated_at\":\"2016-07-15T16:54:14.000+08:00\"},\"project_id\":0,\"title\":\"java.lang.RuntimeException-->237b7b11fac1a22e2838c97ccb83c676\"}\n";
        Issue issue = JSON.parseObject(issueStr, Issue.class);
        Issue created = null;
        try {
            created = service.createNewIssue(String.valueOf(UrlUtils.MARK_ONE_PROJECT_ID), issue);
            System.out.println(JSON.toJSONString(created));
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
